<html>
<head>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto+Condensed:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <title> Парсинг множественной фасты</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet">
    <style>
        body { font-family: Arial; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; }
        .code-block { background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; }
        .download-section { margin: 30px 0; }
    </style>
</head>
<body>
<nav>
            <ul>
                <li><a href="index.html">Главная</a></li>
                <li><a href="l1.html">Лабораторная работа №1</li>
                <li><a href="l2.html">Лабораторная работа №2</a></li>
                <li><a href="l3.html">Лабораторная работа №3</a></li>
                <li><a href="l4.html">Лабораторная работа №4</a></li>
            </ul>
        </nav>
<h1>Задание </h1>
<h2>Цели</h2>
<p> Разработать программу для чтения и обработки файлов в формате мульти-FASTA    </p>
<h2>Задачи</h2>
<p> 1. Чтение файла</p>
<p> 2. Сохранение данных </p>
<p> 3. Вывод результатов </p>



<h2>Инструменты и алгоритмы</h2>
<p>Язык программирования: Python </p>
<h2> Алгоритм </h2>
<p> 1. Открыть файл в формате FASTA и построчно обработать его содержимое. </p>
<p> 2. Корректно определить начало новых последовательностей (по символу `>`). </p>
<p> 3. Сохранить идентификаторы последовательностей (ann) и соответствующие им последовательности (seq) в словаре. </p>
<p> 4. Учесть случаи многострочных последовательностей. </p>
<p> 5. Для каждой последовательности вывести её идентификатор и длину. </p>
<p> 6. Реализовать проверку на пустые файлы или отсутствие последовательностей </p>
<p> 7. Учесть возможные проблемы с форматом файла или его отсутствием </p>

<h2>Ошибки и их исправления </h2>
<p> Некорректный формат файла и ошибки при чтении строк.
 <p> Решение: Добавить проверку на наличие символа > </p>
<p> Последовательности разбиты на несколько строк.  </p>
<p> Решение: Объединять строки до следующего >    </p>
<h2> Вывод</h2>
<p>  Программа готова к использованию для базового анализа FASTA-файлов.  </p>


<h2>Решение</h2>
<div class="code-block">
<pre><code class="language-python">
def fast(path):
    sequence = {}
    with open(path) as fasta:
        ann = None
        seq = []
        for line in fasta:
            line = line.strip()
            if line.startswith('>'):
                if ann is not None:
                    sequence[ann] = ''.join(seq)
                ann = line[1:]
                seq = []
            else:
                seq.append(line)
        if ann is not None:
            sequence[ann] = ''.join(seq)
    return sequence


result = fast("C:/Users/lalin/Downloads/AY883926.fasta")

if result:
    for accession, sequence in result.items():
        print(f"Accession: {accession}\tLength: {len(sequence)}")
        print(f"Sequence:\n{sequence}\n")
else:
    print("Файл пуст или не содержит последовательностей.")
</code></pre>
</div>
<div class="download-section">
    <h3>Сcылки на GitHub</h3>
    <ul>
        <li><a href="https://github.com/ssdfrrr/lab_report/blob/Multifasta/Multifasta.py" download>Исходный код (l3.py)</a></li>

<!-- Подключение скриптов для подсветки кода -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-python.min.js"></script>

</body>
</html>
